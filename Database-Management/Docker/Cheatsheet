#Create a shared Volumne
docker volume create rstudio_data 

#Create a Network change name db_r_shiny to the name you want the network to be called 
docker network create \
  --driver bridge \
  --attachable \
  --scope local \
  --subnet 10.0.42.0/24 \
  --ip-range 10.0.42.128/25 \
  db_r_shiny

#Create an Image change rstudio:1.3.0 to the name you want the image to be called and dockerfile_rstudio to the name of the file 
docker image build --tag rstudio:1.3.0 -f dockerfile_rstudio .

# Create a Container conected to the network db_r_shiny and Image rstudio:1.3.0 change the volumne rstudio_data:/home/rstudio
docker run -d --network db_r_shiny -p 8787:8787 -e PASSWORD=xxxxxxxxxx --name rstudio -v rstudio_data:/home/rstudio rstudio:1.3.0

# Delete and stop container needs to be done to build a new container (we cannot have two containers with the same name) 
docker rm -f rstudio 

# Create RShiny Container
docker run -d \
  -p 3838:3838 \
  --name rshiny \
  -v shiny_app_data:/srv/shiny-server \
  rocker/shiny

#Create Postgres container 
docker run -d \
  -p 5432:5432 \
  --name postgres \
  -e POSTGRES_PASSWORD=xxxxxxxxxxx \
  -e POSTGRES_USER=postgres \
  -v postgres_data:/var/lib/postgresql/data \
  postgres

# Conect Container to Network db_r_shiny (network name) postgres (container name)
docker network connect db_r_shiny postgres
docker network connect db_r_shiny rshiny

#inspect the network 
docker network inspect db_r_shiny

#SAVE IMAGE TO .TAR FILE rstudio_1_0_0.tar is name the file will be given and rstudio:1.0.0 name of the image that will be saved as tar 
docker save -o rstudio:1.3.0.tar rstudio:1.3.0 

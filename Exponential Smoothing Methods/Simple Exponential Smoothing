#The packages we will use frequently need to be called before using functions
library(forecast)
library(stats)
library(datasets)
library(readxl)
library(forecast)

# Example monthly data from Jan 2019 to Dec 2020
data <- c(120,130,125,140,150,145,160,155,165,170,175,180,
          185,190,195,200,205,210,215,220,225,230,235,240)
data_ts <- ts(data, start=c(2019,1), frequency=12)

# Split into train/test (optional for later evaluation)
train_ts <- window(data_ts, end=c(2019,9))
test_ts <- window(data_ts, start=c(2019,10), end=c(2019,12))
h <- length(test_ts)  # or set manually


##### SES ######
ses_fit <- HoltWinters(train_ts, beta=FALSE, gamma=FALSE)
  #no need to specify alpha R will choose best 
  #no trend, no seasonalit -> beta false 
ses_fit
Ses_fc <- forecast(ses_fit, h = h)
Ses_fc

# Plot SES forecast including training data
# Plot SES forecast including training data
plot(Ses_fc, main = "SES Forecast on Training Data", ylab = "Values", xlab = "Time", col = "blue", lwd = 2)

# Calculate error metrics for SES out sample
ses_metrics <- accuracy(Ses_fc, test_ts)
ses_metrics

#Extract Rmse, Mae and mape 
rmse_ses <- ses_metrics["Test set", "RMSE"]
mae_ses  <- ses_metrics["Test set", "MAE"]
mape_ses <- ses_metrics["Test set", "MAPE"]

#Combine metrics into a comparison table
Compare_Models <- data.frame(
  Model = "SES",
  RMSE  = rmse_ses,
  MAE   = mae_ses,
  MAPE  = mape_ses
)
Compare_Models


# if its the best model 
# Fit SES to the full dataset
final_ses_fit <- HoltWinters(data_ts, beta = FALSE, gamma = FALSE)
# Forecast for desired horizon (for example, next 3 months)
final_forecast <- forecast(final_ses_fit, h = ...) #h= forecast_horizon needs to be set manually 
final_forecast
plot(final_forecast)


